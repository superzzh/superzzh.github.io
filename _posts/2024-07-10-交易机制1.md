---
title: 股价是怎样形成的？——撮合成交机制与订单簿
date: 2024-07-10 16:00:00 +0800
categories: [跳动的红绿数字]
tags: [市场微观机制]
---

## 委托

各类投资者委托券商发起交易订单，委托方式有两种：限价委托和市价委托。这样，下单时会发现有两种单：

- 限价委托Limit Order
    - 从朴素的交易者心理分析：
    - 卖股票的人不希望自己的股票贱卖，希望股票买个好价钱，于是给定一个价格，只希望以该价格或者更高价格成交
    - 买股票的人不希望自己买亏了股票，希望买到实惠的股票，于是给定一个价格，只希望以该价格或者更低价格成交

- 市价委托Market Order
    - 按照当前的市场价格买卖股票

市价委托？

## 申报

以上交所股票市场为例，每个交易日的9:15至9:25为开盘集合竞价时间，9:30至11:30、13:00至14:57为连续竞价时间，14:57至15:00为收盘集合竞价时间。其中：
    - 9:20至9:25的开盘集合竞价阶段、14:57至15:00的收盘集合竞价阶段，交易主机不接受撤单申报
    - 其他接受交易申报的时间内，未成交申报可以撤销

## 竞价

证券竞价交易采用集合竞价和连续竞价两种方式：
    - 集合竞价：在规定时间内接受的买卖申报一次性集中撮合的竞价方式
    - 连续竞价：对买卖申报逐笔连续撮合的竞价方式

## 成交

交易市场上，买卖股票的投资者很多，这些交易订单是怎样成交的？

证券竞价交易按价格优先、时间优先的原则撮合成交：
    - 成交时价格优先的原则为：较高价格买入申报优先于较低价格买入申报，较低价格卖出申报优先于较高价格卖出申报。
    - 成交时时间优先的原则为：买卖方向、价格相同的，先申报者优先于后申报者。先后顺序按交易主机接受申报的时间确定。
这样的原则与上面分析的交易者心理是吻合的。

### 连续竞价

在连续竞价时，市场上的买卖行为会反应在订单簿上

|     | 申报量 | 申报价 |        |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
| 卖5 | 1      | 7000   |       |        |      |
| 卖4 | 5      | 6500   |       |        |      |
| 卖3 | 6      | 6000   |       |        |      |
| 卖2 | 10     | 5500   |       |        |      |
| 卖1 | 9      | 5000   |       |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 4500   | 7      | 买1 |
|     |        |        | 4000   | 9      | 买2 |
|     |        |        | 3500   | 2      | 买3 |
|     |        |        | 3000   | 2      | 买4 |
|     |        |        | 2500   | 6      | 买5 |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 申报价 | 申报量  |     |

卖1与买1分别是买卖双方最接近成交价的价格，此处卖1~卖5向上依次递增，买1~买5向下依次递减，订单簿有两个特点：
- 符合上面分析的交易者心理：卖方能接受不低于出价的成交，即卖价及卖价上方的价格；买方同理，买方能接受不高于出价的成交，即买价及买价下方的价格
- 符合上面阐明的价格优先原则：买方喜欢较低价格卖出的，而卖方喜欢较高价格买入的

在上面这个时刻的订单簿中，最低卖价高于最高买价，故无成交。下一时刻，出现了新的卖单：

|     | 申报量 | 申报价 |        |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
| 卖6 | 1      | 7000   |       |        |      |
| 卖5 | 5      | 6500   |       |        |      |
| 卖4 | 6      | 6000   |       |        |      |
| 卖3 | 10     | 5500   |       |        |      |
| 卖2 | 9      | 5000   |       |        |      |
| 卖1 | 3      | 4500   | 4500   | 7      | 买1 |
|     |        |        | 4000   | 9      | 买2 |
|     |        |        | 3500   | 2      | 买3 |
|     |        |        | 3000   | 2      | 买4 |
|     |        |        | 2500   | 6      | 买5 |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 申报价 | 申报量  |     |

此时卖1价与买1价相同，立即成交，最新成交价：4500，成交量：3笔。最新股价就定为4500。订单簿更新为如下状态:

|     | 申报量 | 申报价 |        |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
| 卖5 | 1      | 7000   |       |        |      |
| 卖4 | 5      | 6500   |       |        |      |
| 卖3 | 6      | 6000   |       |        |      |
| 卖2 | 10     | 5500   |       |        |      |
| 卖1 | 9      | 5000   |       |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 4500   | 4      | 买1 |
|     |        |        | 4000   | 9      | 买2 |
|     |        |        | 3500   | 2      | 买3 |
|     |        |        | 3000   | 2      | 买4 |
|     |        |        | 2500   | 6      | 买5 |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 申报价 | 申报量  |     |

下一时刻，又出现了新的卖单：

|     | 申报量 | 申报价 |        |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
| 卖5 | 1      | 7000   |       |        |      |
| 卖4 | 5      | 6500   |       |        |      |
| 卖3 | 6      | 6000   |       |        |      |
| 卖2 | 10     | 5500   |       |        |      |
| 卖1 | 9      | 5000   | 5000   | 5      | 买1  |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 4500   | 4      | 买2 |
|     |        |        | 4000   | 9      | 买3 |
|     |        |        | 3500   | 2      | 买4 |
|     |        |        | 3000   | 2      | 买5 |
|     |        |        | 2500   | 6      | 买6 |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 申报价 | 申报量  |     |

此时卖1价与买1价相同，立即成交，最新成交价：5000，成交量：5笔。最新股价就定为5000。订单簿更新为如下状态:

|     | 申报量 | 申报价 |        |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
| 卖5 | 1      | 7000   |       |        |      |
| 卖4 | 5      | 6500   |       |        |      |
| 卖3 | 6      | 6000   |       |        |      |
| 卖2 | 10     | 5500   |       |        |      |
| 卖1 | 4      | 5000   |       |        |      |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 4500   | 4      | 买1 |
|     |        |        | 4000   | 9      | 买2 |
|     |        |        | 3500   | 2      | 买3 |
|     |        |        | 3000   | 2      | 买4 |
|     |        |        | 2500   | 6      | 买5 |
|:----|:-------|:-------|:-------|:-------|:----|
|     |        |        | 申报价 | 申报量  |     |

这样，就解释了股价是怎么确定的：

股价根据买卖双方即时成交价确定，它是双方博弈的体现。

总结下来，连续竞价的成交价格确定原则为：
- 最高买入申报价格与最低卖出申报价格相同，以该价格为成交价格
- 买入申报价格高于即时揭示的最低卖出申报价格的，以即时揭示的最低卖出申报价格为成交价格
- 卖出申报价格低于即时揭示的最高买入申报价格的，以即时揭示的最高买入申报价格为成交价格

在实际交易过程中，买1和卖1总是差一点点。一旦相同或者有交集，便立刻按照撮合成交机制成交。

一定要相同才会撮合成交吗？

在上面的例子中，有卖家出价等于买1而成交，这样的成交称为内盘，说明卖方比较积极；也有买家出价等于卖1而成交，这样的成交称为外盘，说明买方比较积极。当成交价在卖出价时，将成交数量加入外盘累计数量中，当外盘累计数量比内盘累计数量大很多，表示很多人在抢盘买入股票，这时股票有股价上涨趋势。

集合竞价？